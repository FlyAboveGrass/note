---
title: "如何判断两张图片是否类似"
source: "https://juejin.cn/post/7143165251779821604"
author:
  - "[[乔瑟琳]]"
published: 2022-09-14
created: 2025-12-12
description: "如何判断两张图是否相似？ 查到了很多算法，流程都是“特征提取”，“特征对比”。以下列出了三个常见算法的浅显的介绍， ### 平均哈希算法 平均哈希算法是三种Hash算法中最简单的一种，它通过下面几个"
tags:
  - "clippings"
---
[乔瑟琳](https://juejin.cn/user/2225067264595709/posts)

735 阅读2分钟

如何判断两张图是否相似？ 查到了很多算法，流程都是“特征提取”，“特征对比”。以下列出了三个常见算法的浅显的介绍，

# 平均哈希算法

平均哈希算法是三种Hash算法中最简单的一种，它通过下面几个步骤来获得图片的Hash值，这几个步骤分别是(1) 缩放图片；（2）转灰度图; (3) 算像素均值；（4）根据相似均值计算指纹。具体算法如下所示:![1.1 aHash得到图片Hash值地算法](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c8c16be39d6e4e978e57caa39aec7041~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?) 得到图片的ahash值后，比较两张图片ahash值的汉明距离，通常认为汉明距离小于10的一组图片为相似图片。

## 例子

![1.2 原图以及灰度后的图像](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/306d5e359285430586600e33ac367ede~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?)

### 其中转为8x8尺寸的Lena对应的数据矩阵为

![1.3 数据矩阵](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/09851a2044ce4ab3b0a374d67cbcc561~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?)

### 很容得到如上矩阵所有元素的均值a= 121.328125, 将上述矩阵中大于或等于a的元素置为1, 小于a的元素置为0，可得

![1.4转换为1的矩阵](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1edf2ef7fc274d5ba120568c9d2968eb~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp) 所以可得Lena图的aHash为

```bash
1011111010011110100111011010100110101011101000110000111000101100

   将二进制形式ahash转十六进制hash为

   be9e9da9aba30e2c
```

将两张图片进行平均hash后，再计算出各自的汉明距离

### 图Lena(noise)

![图Lena(noise)](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ba48602aff3444a4a2354de6f935013f~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp)

### 图Barbara

![图Barbara](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c9c8d327e0f84c1a866b1ce5f459feff~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp)

### 图汉明距离

![图汉明距离](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/99d1057ee9c34944ba97a06efb06c1e2~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp)

# 感知哈希算法

感知哈希算法是三种Hash算法中较为复杂的一种，它是基于DCT（离散余弦变换）来得到图片的hash值（补充：关于DCT具体如何转换参考 [www.jianshu.com/p/b923cd47a…](https://link.juejin.cn/?target=https%3A%2F%2Fwww.jianshu.com%2Fp%2Fb923cd47ac4a "https://www.jianshu.com/p/b923cd47ac4a") ），其算法几个步骤分别是(1) 缩放图片；（2）转灰度图; (3) 计算DCT；（4）缩小DCT; (5)算平均值；(6) 计算指纹。具体算法如下所示:![感知hash的步骤](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b10cd8635ad54d2db3aa8cb67b1e542e~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp)

# 差异哈希算法

相比pHash，dHash的速度要快的多，相比aHash，dHash在效率几乎相同的情况下的效果要更好，它是基于渐变实现的。其算法几个步骤分别是(1) 缩放图片（2）转灰度图; （3）算差异值； （4）算平均值; （5）计算指纹。具体算法如下所示:![差异哈希流程](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4d92eb2588514ced9d408b8b7bd8338c~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp)

文章参考了： [t.zoukankan.com/kalafinaian…](https://link.juejin.cn/?target=http%3A%2F%2Ft.zoukankan.com%2Fkalafinaian-p-11260808.html "http://t.zoukankan.com/kalafinaian-p-11260808.html")

具体平均hash的测试代码详见： [github.com/yuanting201…](https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fyuanting2016%2Fsimilarpicture "https://github.com/yuanting2016/similarpicture")
