# ğŸ§  â€‹**ä¸€ã€Jest çš„æ ¸å¿ƒä¼˜åŠ¿ä¸è®¾è®¡ç†å¿µ**â€‹

1. â€‹**é›¶é…ç½®å¯åŠ¨**â€‹
    å®‰è£…åæ— éœ€å¤æ‚é…ç½®å³å¯è¿è¡Œæµ‹è¯•ï¼ˆ`npm install --save-dev jest`ï¼‰ï¼Œè‡ªåŠ¨è¯†åˆ«Â `.test.js`Â æˆ–Â `.spec.js`Â æ–‡ä»¶ã€‚
2. â€‹**å¹¶è¡Œæµ‹è¯•**â€‹
    æ™ºèƒ½éš”ç¦»æµ‹è¯•æ–‡ä»¶å¹¶è¡Œæ‰§è¡Œï¼Œå¤§å¹…æå‡å¤§å‹é¡¹ç›®æµ‹è¯•é€Ÿåº¦ã€‚
3. â€‹**å†…ç½®è¦†ç›–ç‡æŠ¥å‘Š**â€‹
    é€šè¿‡Â `jest --coverage`Â ç”Ÿæˆä»£ç è¦†ç›–ç‡æŠ¥å‘Šï¼Œç›´è§‚å±•ç¤ºæœªè¦†ç›–ä»£ç ã€‚
4. â€‹**å¿«ç…§æµ‹è¯•ï¼ˆSnapshot Testingï¼‰â€‹**â€‹
    æ•è·ç»„ä»¶/æ•°æ®ç»“æ„è¾“å‡ºï¼Œè‡ªåŠ¨å¯¹æ¯”å†å²å¿«ç…§ï¼Œå¿«é€Ÿæ£€æµ‹ UI æˆ–é€»è¾‘å˜æ›´ã€‚

---

# âš™ï¸ â€‹**äºŒã€å…³é”® API è¯¦è§£**â€‹

## â€‹**1. æµ‹è¯•å®šä¹‰ä¸ç»„ç»‡**â€‹

- â€‹**`describe(name, fn)`**â€‹
    åˆ›å»ºæµ‹è¯•å¥—ä»¶ï¼ˆç»„ï¼‰ï¼Œå…³è”å¤šä¸ªæµ‹è¯•ç”¨ä¾‹

    ï¼š


    ```javascript
    describe('Mathæ¨¡å—', () => {
      // æµ‹è¯•ç”¨ä¾‹...
    });
    ```

- â€‹**`test(name, fn)`Â æˆ–Â `it(name, fn)`**â€‹
    å®šä¹‰å•ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼š


    ```javascript
    test('1+2=3', () => {
      expect(add(1, 2)).toBe(3);
    })[3,5](@ref)ã€‚
    ```

## â€‹**2. æ–­è¨€ä¸åŒ¹é…å™¨ï¼ˆMatchersï¼‰â€‹**â€‹

Jest ä½¿ç”¨Â `expect(value).matcher(expected)`Â ç»“æ„ï¼š

|â€‹**åŒ¹é…å™¨**â€‹|â€‹**ç”¨é€”**â€‹|â€‹**ç¤ºä¾‹**â€‹|
|---|---|---|
|`toBe(value)`|ä¸¥æ ¼ç›¸ç­‰ï¼ˆ`===`ï¼‰|`expect(sum(1,2)).toBe(3)`|
|`toEqual(object)`|æ·±åº¦é€’å½’å¯¹è±¡æ¯”è¾ƒ|`expect(obj).toEqual({id:1})`|
|`toContain(item)`|æ£€æŸ¥æ•°ç»„/å­—ç¬¦ä¸²åŒ…å«|`expect(['a','b']).toContain('a')`|
|`toMatch(regex)`|æ­£åˆ™åŒ¹é…å­—ç¬¦ä¸²|`expect('hello').toMatch(/ll/)`|
|`toThrow(error?)`|éªŒè¯å‡½æ•°æŠ›å‡ºå¼‚å¸¸|`expect(() => fn()).toThrow('Error')`|
|`resolves`/`rejects`|å¤„ç†å¼‚æ­¥ Promise ç»“æœ|`await expect(fetchData()).resolves.toBe(data)`|
|`toHaveBeenCalled()`|éªŒè¯ Mock å‡½æ•°è¢«è°ƒç”¨ï¼ˆéœ€æ­é…Â `jest.fn()`ï¼‰|`expect(mockFn).toHaveBeenCalled()`|

> ğŸ’¡ æ›´å¤šåŒ¹é…å™¨ï¼šæµ®ç‚¹æ•°æ¯”è¾ƒï¼ˆ`toBeCloseTo(0.3)`ï¼‰ã€é•¿åº¦æ£€æŸ¥ï¼ˆ`toHaveLength(3)`ï¼‰ç­‰
>
> ã€‚

## â€‹**3. æ¨¡æ‹Ÿï¼ˆMockï¼‰åŠŸèƒ½**â€‹

- â€‹**`jest.fn(impl?)`**â€‹
    åˆ›å»ºå¯è¿½è¸ªè°ƒç”¨çš„æ¨¡æ‹Ÿå‡½æ•°ï¼š


    ```javascript
    const mockFn = jest.fn(x => x + 1);
    mockFn(1);
    expect(mockFn.mock.calls[0][0]).toBe(1); // æ£€æŸ¥å‚æ•°[4,5](@ref)
    ```

- â€‹**`jest.mock(modulePath, factory?)`**â€‹
    æ¨¡æ‹Ÿæ•´ä¸ªæ¨¡å—ï¼ˆå¦‚ API è¯·æ±‚ï¼‰ï¼š


    ```javascript
    jest.mock('./api', () => ({ fetchData: jest.fn(() => Promise.resolve({ data: 'mock' })) })[4,5](@ref)ã€‚
    ```

## â€‹**4. ç”Ÿå‘½å‘¨æœŸé’©å­**â€‹

æ§åˆ¶æµ‹è¯•ç¯å¢ƒåˆå§‹åŒ–ä¸æ¸…ç†ï¼š

javascript

è¿è¡Œ

å¤åˆ¶

```javascript
beforeAll(() => initDB());   // æ‰€æœ‰æµ‹è¯•å‰æ‰§è¡Œ
afterEach(() => clearCache()); // æ¯ä¸ªæµ‹è¯•åæ‰§è¡Œ
beforeEach(() => resetState()); // æ¯ä¸ªæµ‹è¯•å‰æ‰§è¡Œ[5](@ref)
```

---

# ğŸ› ï¸ â€‹**ä¸‰ã€å®ç”¨æŠ€å·§ä¸æœ€ä½³å®è·µ**â€‹

1. â€‹**å¼‚æ­¥æµ‹è¯•**â€‹
    ä½¿ç”¨Â `async/await`Â æˆ–Â `resolves/rejects`Â é¿å…å›è°ƒåµŒå¥—ã€‚
2. â€‹**å¿«ç…§æ›´æ–°ç­–ç•¥**â€‹
    ä»£ç å˜æ›´åè¿è¡ŒÂ `jest --updateSnapshot`Â æ›´æ–°å¿«ç…§

    ã€‚
3. â€‹**ç»„ä»¶æµ‹è¯•ï¼ˆReact/Vueï¼‰â€‹**â€‹
    æ­é…Â `@testing-library/react`Â æˆ–Â `@vue/test-utils`Â è¿›è¡Œ DOM äº¤äº’æµ‹è¯•

    ã€‚
4. â€‹**é…ç½®æ–‡ä»¶ (`jest.config.js`)â€‹**â€‹
    å®šåˆ¶æµ‹è¯•ç¯å¢ƒï¼ˆå¦‚Â `testEnvironment: 'jsdom'`Â æ¨¡æ‹Ÿæµè§ˆå™¨ç¯å¢ƒï¼‰

    ã€‚
